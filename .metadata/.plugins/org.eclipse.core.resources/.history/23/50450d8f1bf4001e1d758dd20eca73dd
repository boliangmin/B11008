/************************************************************************************************************************************************
* 文件名称: hal_i2c.c
* 文件描述: i2c驱动相关封装函数
* 维护人员: bo.liangmin
* 版本信息: 20240406--代码创建
************************************************************************************************************************************************/



/************************************************************************************************************************************************
* include
************************************************************************************************************************************************/
#include "hal_i2c.h"
#include "sys_common.h"
#include "driver/i2c.h"



/************************************************************************************************************************************************
* define
************************************************************************************************************************************************/
static int hal_i2c_inst = SYS_I2C_INST;

static i2c_config_t hal_i2c_cfg =
{
    .mode = I2C_MODE_MASTER,
    .sda_io_num = SYS_I2C_SDA_PIN,
    .scl_io_num = SYS_I2C_SCL_PIN,
    .sda_pullup_en = GPIO_PULLUP_ENABLE,
    .scl_pullup_en = GPIO_PULLUP_ENABLE,
    .master.clk_speed = SYS_I2C_FREQ_HZ,
};



/************************************************************************************************************************************************
* 函数名称: void AHT_DeviceInit(void)
* 函数说明: 设备初始化
* 输入参数: 无
* 输出参数: 无
* 返回数值: 无
************************************************************************************************************************************************/
esp_err_t HAL_I2C_Init(void)
{
    i2c_param_config(hal_i2c_inst, &hal_i2c_cfg);

    return i2c_driver_install(hal_i2c_inst, hal_i2c_cfg.mode, SYS_I2C_TX_BUF_DISABLE, SYS_I2C_RX_BUF_DISABLE, 0);
}

/************************************************************************************************************************************************
* 函数名称: esp_err_t HAL_I2C_WriteCommand(uint8_t device_addr, uint8_t* command, uint16_t len)
* 函数说明: 向I2C设备写指令
* 输入参数: 无
* 输出参数: 无
* 返回数值: 无
************************************************************************************************************************************************/
esp_err_t HAL_I2C_WriteCommand(uint8_t device_addr, uint8_t* command, uint16_t len)
{
    return i2c_master_write_to_device(hal_i2c_inst, device_addr, command, sizeof(command), 100);
}

/************************************************************************************************************************************************
* 函数名称: esp_err_t HAL_I2C_ReadData(uint8_t device_addr, uint8_t* read_buff, uint16_t len)
* 函数说明: 从I2C设备读数据
* 输入参数: 无
* 输出参数: 无
* 返回数值: 无
************************************************************************************************************************************************/
esp_err_t HAL_I2C_ReadData(uint8_t device_addr, uint8_t* read_buff, uint16_t len)
{
    return i2c_master_read_from_device(hal_i2c_inst, device_addr, read_buff, len, 100);
}



/************************************************************************************************************************************************
* end
************************************************************************************************************************************************/


